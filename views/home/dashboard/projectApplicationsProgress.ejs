<div class="page-wrapper py-5">
    <div class="container">
        <h1 class="text-center mb-5 ">Application Progress</h1>



        <%- include(`../../partials/notification`) %>
        <div class="row g-4">
            <% projects.forEach((app, index) => { %>
                <div class="col-12">
                    <div class="card shadow-sm border-0 rounded">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0">Project Title: <%= app.title %></h5>
                            <span class="badge bg-secondary"><%= app.status %></span>
                        </div>
                        <div class="card-body">
                            <p class="mb-1"><strong>Project Type:</strong> <%= app.projectType %></p>
                            <p class="mb-1"><strong>Project Scope:</strong> <%= app.projectScope %></p>
                            <p class="mb-1">
                                <strong>Value:</strong> $<%= app.projectValue.toLocaleString() %> 
                                | <strong>Duration:</strong> <%= app.duration %> months
                            </p>
                            <p class="mb-3"><strong>Objectives:</strong> <%= app.objectives %></p>
                           

                            <button class="btn btn-outline-primary" type="button" data-bs-toggle="collapse" data-bs-target="#details-<%= index %>" aria-expanded="false">
                                View Details
                            </button>

                            <div class="collapse mt-3" id="details-<%= index %>">
                                <h6 class="text-secondary">Locations</h6>
                                <ul class="list-unstyled mb-3">
                                    <% app.locations.forEach(loc => { %>
                                        <li>
                                            <strong><%= loc.name %>:</strong> <%= loc.description %> 
                                            (<%= loc.latitude %>, <%= loc.longitude %>)
                                        </li>
                                    <% }) %>
                                </ul>

                                <h6 class="text-secondary">Workers</h6>
                                <ul class="list-unstyled mb-3">
                                    <li><strong>Professionals:</strong> <%= app.workers.professionals %></li>
                                    <li><strong>Skilled:</strong> <%= app.workers.skilled %></li>
                                    <li><strong>Semi-Skilled:</strong> <%= app.workers.semiSkilled %></li>
                                    <li><strong>Unskilled:</strong> <%= app.workers.unskilled %></li>
                                </ul>

                                <h6 class="text-secondary">Attached Files</h6>
                                <ul class="list-unstyled">
                                    <li>
                                        <% if (app.documents.CFEdoc) { %>
                                            <a href="<%= app.documents.CFEdoc %>" download class="btn btn-link p-0 text-primary">
                                                <button class="btn btn-sm text-white btn-primary">
                                                    Corporate File (CF)
                                                </button>
                                            </a>
                                        <% } else { %>
                                            <form method="POST" action="/dashboard/uploadProjectDoc/CFEdoc" enctype="multipart/form-data">
                                                <label for="uploadCFEdoc" class="btn btn-rounded btn-outline-danger">
                                                    Upload Corporate File (CF)
                                                </label>

                                                <input type="text" name="userId" hidden value="<%=app._id %>" id="">
                                                <input type="file" id="uploadCFEdoc" name="uploadSingleDoc" style="display: none;" onchange="this.form.submit()" />
                                            </form>
                                        <% } %>
                                    </li>
                                    <li>
                                        <% if (app.documents.pastExperienceRefDoc) { %>
                                            <a href="<%= app.documents.pastExperienceRefDoc %>" download class="btn btn-link p-0 text-primary">
                                                <button class="btn btn-sm text-white btn-primary">
                                                    Risk Management Plan
                                                </button>
                                                
                                            </a>
                                        <% } else { %>
                                            <form method="POST" action="/dashboard/uploadProjectDoc/pastExperienceRefDoc" enctype="multipart/form-data">
                                                <label for="uploadPastExperience" class="btn btn-rounded btn-outline-danger">
                                                    Upload Risk Management Plan
                                                    <i class="ion-alert-circled"></i>
                                                </label>
                                                <input type="text" name="userId" hidden value="<%=app._id %>" id="">
                                                <input type="file" id="uploadPastExperience" name="uploadSingleDoc" style="display: none;" onchange="this.form.submit()" />
                                            </form>
                                        <% } %>
                                    </li>
                                    <li>
                                        <% if (app.documents.CFCdoc) { %>
                                            <a href="<%= app.documents.CFCdoc %>" download class="btn btn-link p-0 text-primary">
                                                <button class="btn btn-sm text-white btn-primary">
                                                    Audited Financial Statements
                                                </button>
                                            </a>
                                        <% } else { %>
                                            <form method="POST" action="/dashboard/uploadProjectDoc/CFCdoc" enctype="multipart/form-data">
                                                <label for="uploadCFCdoc" class="btn btn-rounded btn-outline-danger">
                                                    Upload Audited Financial Statements
                                                </label>
                                                <input type="text" name="userId" hidden value="<%=app._id %>" id="">
                                                <input type="file" id="uploadCFCdoc" name="uploadSingleDoc" style="display: none;" onchange="this.form.submit()" />
                                            </form>
                                        <% } %>
                                    </li>
                                    <li>
                                        <% if (app.documents.taxComplianceDoc) { %>
                                            <a href="<%= app.documents.taxComplianceDoc %>" download class="btn btn-link p-0 text-primary">
                                                <button class="btn btn-sm text-white btn-primary">
                                                    Standard operating procedures (SOPs)
                                                </button>
                                            </a>
                                        <% } else { %>
                                            <form method="POST" action="/dashboard/uploadProjectDoc/taxComplianceDoc" enctype="multipart/form-data">
                                                <label for="uploadTaxCompliance" class="btn btn-rounded btn-outline-danger">
                                                    Upload Standard operating procedures (SOPs)
                                                </label>
                                                <input type="text" name="userId" hidden value="<%=app._id %>" id="">
                                                <input type="file" id="uploadTaxCompliance" name="uploadSingleDoc" style="display: none;" onchange="this.form.submit()" />
                                            </form>
                                        <% } %>
                                    </li>
                                    <li>
                                        <% if (app.documents.proofOfAdherenceDoc) { %>
                                            <a href="<%= app.documents.proofOfAdherenceDoc %>" download class="btn btn-link p-0 text-primary">
                                                <button class="btn btn-sm text-white btn-primary">
                                                    Projected Price Structure and Delivery Schedule
                                                </button>
                                            </a>
                                        <% } else { %>
                                            <form method="POST" action="/dashboard/uploadProjectDoc/proofOfAdherenceDoc" enctype="multipart/form-data">
                                                <label for="uploadProofOfAdherence" class="btn btn-rounded btn-outline-danger">
                                                    Upload Projected Price Structure and Delivery Schedule
                                                </label>
                                                <input type="text" name="userId" hidden value="<%=app._id %>" id="">
                                                <input type="file" id="uploadProofOfAdherence" name="uploadSingleDoc" style="display: none;" onchange="this.form.submit()" />
                                            </form>
                                        <% } %>
                                    </li>
                                    <li>
                                        <% if (app.documents.commercialInvoice) { %>
                                            <a href="<%= app.documents.commercialInvoice %>" download class="btn btn-link p-0 text-primary">
                                                <button class="btn btn-sm text-white btn-primary">
                                                    Invoice
                                                </button>
                                            </a>
                                        <% } else { %>
                                            <form method="POST" action="/dashboard/uploadProjectDoc/commercialInvoice" enctype="multipart/form-data">
                                                <label for="uploadCommercialInvoice" class="btn btn-rounded btn-outline-danger">
                                                    Upload Invoice
                                                    
                                                </label>
                                                <input type="text" name="userId" hidden value="<%=app._id %>" id="">
                                                <input type="file" id="uploadCommercialInvoice" name="uploadSingleDoc" style="display: none;" onchange="this.form.submit()" />
                                            </form>
                                        <% } %>
                                    </li>
                                    <li>
                                        <% if (app.documents.noticeOfAwardDoc) { %>
                                            <a href="<%= app.documents.noticeOfAwardDoc %>" download class="btn btn-link p-0 text-primary">
                                                <button class="btn btn-sm text-white btn-primary">
                                                    Notice of Award Document
                                                </button>
                                            </a>
                                        <% } else { %>
                                            <form method="POST" action="/dashboard/uploadProjectDoc/noticeOfAwardDoc" enctype="multipart/form-data">
                                                <label for="uploadNoticeOfAward" class="btn btn-rounded btn-outline-danger">
                                                    Upload Notice of Award Document
                                                </label>
                                                <input type="text" name="userId" hidden value="<%=app._id %>" id="">
                                                <input type="file" id="uploadNoticeOfAward" name="uploadSingleDoc" style="display: none;" onchange="this.form.submit()" />
                                            </form>
                                        <% } %>
                                    </li>
                                </ul>
                                
                             
                            </div>
                        </div>
                      
                    </div>
                </div>
            <% }) %>
        </div>
    </div>
</div>



<style>
    .mb-3 {
      display: inline-block; /* Prevent text wrapping */
      overflow: hidden; /* Hide the overflowing text */
      white-space: nowrap; /* Prevent the text from wrapping to a new line */
      text-overflow: ellipsis; /* Add ellipsis to indicate the text is truncated */
      width: fit-content; /* Adjust width to fit content */
      max-width: calc(15ch + 10em); /* Adjust width to accommodate 5 words (approx. 5 characters per word + padding) */
    }
  </style>
  